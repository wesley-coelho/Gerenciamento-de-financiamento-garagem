/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JInternalFrame.java to edit this template
 */
package com.wesleycoelho.view;

import com.wesleycoelho.controllers.jdbc.conn.FinanciamentoDB;
import com.wesleycoelho.model.EntradaVeiculo;
import com.wesleycoelho.model.Usuario;
import javax.swing.JOptionPane;
import com.wesleycoelho.model.Cliente;
import com.wesleycoelho.model.Financiamento;
import com.wesleycoelho.model.PrintingTodosFinanciamentos;
import com.wesleycoelho.model.SaidaVeiculo;
import java.awt.print.PrinterException;
import java.awt.print.PrinterJob;
import java.util.List;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author Wesley
 */
public class FormListarTodosFinanciamento extends javax.swing.JInternalFrame {
    Usuario usuario = new Usuario();
    EntradaVeiculo entrada;
    Cliente cliente;
    Financiamento financiamento;
    List<Financiamento> listaFinanciamento;
    SaidaVeiculo saida;
    /**
     * Creates new form FormNovaEntrada
     */
    public FormListarTodosFinanciamento(Usuario user) {
        this.usuario = user;
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jToolBar1 = new javax.swing.JToolBar();
        btnSalvarFinanciamento = new javax.swing.JButton();
        btnImprimirFinanciamento = new javax.swing.JButton();
        btnExcluirEntrada = new javax.swing.JButton();
        btnLimparFormularioEntrada = new javax.swing.JButton();
        jSeparator1 = new javax.swing.JToolBar.Separator();
        filler1 = new javax.swing.Box.Filler(new java.awt.Dimension(0, 0), new java.awt.Dimension(0, 0), new java.awt.Dimension(10, 0));
        btnPesquisarFinanciamento = new javax.swing.JButton();
        cbFiltroFinanciamento = new javax.swing.JComboBox<>();
        jScrollPane1 = new javax.swing.JScrollPane();
        tbFinanciamento = new javax.swing.JTable();

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("TODOS financiamento");
        setFrameIcon(new javax.swing.ImageIcon(getClass().getResource("/icons8-add-car-16_1.png"))); // NOI18N
        setVisible(true);
        addAncestorListener(new javax.swing.event.AncestorListener() {
            public void ancestorAdded(javax.swing.event.AncestorEvent evt) {
                formAncestorAdded(evt);
            }
            public void ancestorMoved(javax.swing.event.AncestorEvent evt) {
            }
            public void ancestorRemoved(javax.swing.event.AncestorEvent evt) {
                formAncestorRemoved(evt);
            }
        });
        addInternalFrameListener(new javax.swing.event.InternalFrameListener() {
            public void internalFrameActivated(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameClosed(javax.swing.event.InternalFrameEvent evt) {
                formInternalFrameClosed(evt);
            }
            public void internalFrameClosing(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameDeactivated(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameDeiconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameIconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameOpened(javax.swing.event.InternalFrameEvent evt) {
                formInternalFrameOpened(evt);
            }
        });

        jToolBar1.setEnabled(false);
        jToolBar1.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jToolBar1.setMargin(new java.awt.Insets(0, 5, 0, 5));

        btnSalvarFinanciamento.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons8-save-16.png"))); // NOI18N
        btnSalvarFinanciamento.setToolTipText("Salvar");
        btnSalvarFinanciamento.setEnabled(false);
        btnSalvarFinanciamento.setFocusable(false);
        btnSalvarFinanciamento.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnSalvarFinanciamento.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnSalvarFinanciamento.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSalvarFinanciamentoActionPerformed(evt);
            }
        });
        jToolBar1.add(btnSalvarFinanciamento);

        btnImprimirFinanciamento.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons8-print-16.png"))); // NOI18N
        btnImprimirFinanciamento.setToolTipText("Imprimir");
        btnImprimirFinanciamento.setFocusable(false);
        btnImprimirFinanciamento.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnImprimirFinanciamento.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnImprimirFinanciamento.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnImprimirFinanciamentoActionPerformed(evt);
            }
        });
        jToolBar1.add(btnImprimirFinanciamento);

        btnExcluirEntrada.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons8-delete-trash-16.png"))); // NOI18N
        btnExcluirEntrada.setToolTipText("Excluir");
        btnExcluirEntrada.setEnabled(false);
        btnExcluirEntrada.setFocusable(false);
        btnExcluirEntrada.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnExcluirEntrada.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnExcluirEntrada.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnExcluirEntradaActionPerformed(evt);
            }
        });
        jToolBar1.add(btnExcluirEntrada);

        btnLimparFormularioEntrada.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons8-broom-16.png"))); // NOI18N
        btnLimparFormularioEntrada.setToolTipText("Limpar Formulário");
        btnLimparFormularioEntrada.setEnabled(false);
        btnLimparFormularioEntrada.setFocusable(false);
        btnLimparFormularioEntrada.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnLimparFormularioEntrada.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnLimparFormularioEntrada.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btnLimparFormularioEntradaMouseClicked(evt);
            }
        });
        btnLimparFormularioEntrada.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLimparFormularioEntradaActionPerformed(evt);
            }
        });
        jToolBar1.add(btnLimparFormularioEntrada);
        jToolBar1.add(jSeparator1);
        jToolBar1.add(filler1);

        btnPesquisarFinanciamento.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icons8-filter-16.png"))); // NOI18N
        btnPesquisarFinanciamento.setFocusable(false);
        btnPesquisarFinanciamento.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnPesquisarFinanciamento.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnPesquisarFinanciamento.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnPesquisarFinanciamentoActionPerformed(evt);
            }
        });
        jToolBar1.add(btnPesquisarFinanciamento);

        cbFiltroFinanciamento.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Todos" }));
        cbFiltroFinanciamento.setMaximumSize(new java.awt.Dimension(200, 22));
        jToolBar1.add(cbFiltroFinanciamento);

        jScrollPane1.setHorizontalScrollBarPolicy(javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS);
        jScrollPane1.setVerticalScrollBarPolicy(javax.swing.ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);

        tbFinanciamento.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {},
                {},
                {},
                {}
            },
            new String [] {

            }
        ));
        tbFinanciamento.setAutoResizeMode(javax.swing.JTable.AUTO_RESIZE_OFF);
        jScrollPane1.setViewportView(tbFinanciamento);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jToolBar1, javax.swing.GroupLayout.DEFAULT_SIZE, 677, Short.MAX_VALUE)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                        .addComponent(jScrollPane1)
                        .addContainerGap())))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jToolBar1, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 408, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void btnSalvarFinanciamentoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSalvarFinanciamentoActionPerformed
        // TODO add your handling code here:
      
       
        
        
    }//GEN-LAST:event_btnSalvarFinanciamentoActionPerformed

    private void btnImprimirFinanciamentoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnImprimirFinanciamentoActionPerformed
        
        if( this.tbFinanciamento.getModel().getRowCount() > 0 ){
            try {

                PrinterJob job = PrinterJob.getPrinterJob();
                job.setPrintable(new PrintingTodosFinanciamentos(this.tbFinanciamento));
                boolean doPrint = job.printDialog();
                if (doPrint) job.print();
            } catch (PrinterException | IndexOutOfBoundsException ex) {
                JOptionPane.showMessageDialog(rootPane,"Error: " + ex.getMessage());
            }
        }
    }//GEN-LAST:event_btnImprimirFinanciamentoActionPerformed

    private void btnExcluirEntradaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnExcluirEntradaActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnExcluirEntradaActionPerformed

    private void btnLimparFormularioEntradaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLimparFormularioEntradaActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnLimparFormularioEntradaActionPerformed

    private void formInternalFrameOpened(javax.swing.event.InternalFrameEvent evt) {//GEN-FIRST:event_formInternalFrameOpened
        // TODO add your handling code here:
        
        Financiamento.janelaListaTodosFinanciamento = true;
        System.out.println(Financiamento.janelaListaTodosFinanciamento);
        
    }//GEN-LAST:event_formInternalFrameOpened

    private void formInternalFrameClosed(javax.swing.event.InternalFrameEvent evt) {//GEN-FIRST:event_formInternalFrameClosed
        // TODO add your handling code here:
        Financiamento.janelaListaTodosFinanciamento = false;
    }//GEN-LAST:event_formInternalFrameClosed

    private void formAncestorAdded(javax.swing.event.AncestorEvent evt) {//GEN-FIRST:event_formAncestorAdded
        // TODO add your handling code here:
        Financiamento.janelaListaTodosFinanciamento = true;
    
    }//GEN-LAST:event_formAncestorAdded

    private void formAncestorRemoved(javax.swing.event.AncestorEvent evt) {//GEN-FIRST:event_formAncestorRemoved
        // TODO add your handling code here:
        Financiamento.janelaListaTodosFinanciamento = false;
   
    }//GEN-LAST:event_formAncestorRemoved

    private void btnLimparFormularioEntradaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btnLimparFormularioEntradaMouseClicked
        // TODO add your handling code here:
        
        
    }//GEN-LAST:event_btnLimparFormularioEntradaMouseClicked

    private void btnPesquisarFinanciamentoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnPesquisarFinanciamentoActionPerformed
        // TODO add your handling code here: 
        if( this.cbFiltroFinanciamento.getSelectedItem().toString() == "Todos" ){
            this.listaFinanciamento = FinanciamentoDB.selectAll();
            if( this.listaFinanciamento != null){
                DefaultTableModel tableModel;
                tableModel = (DefaultTableModel) this.tbFinanciamento.getModel();
                tableModel.setNumRows(0);
                Object[] headers = new Object[9];
                headers[0] = "Id";
                headers[1] = "Ficha";
                headers[2] = "Data";
                headers[3] = "Cliente";
                headers[4] = "Placa";               
                headers[5] = "Valor parcela";
                headers[6] = "Parcelas";
                headers[7] = "Vencimento (dia)";
                headers[8] = "Observação";
                tableModel.setColumnIdentifiers(headers);
                for(Financiamento f: listaFinanciamento ){
                    
                    Object[] colunas = new Object[11];
                    colunas[0] = f.getId();
                    colunas[1] = f.getFicha();
                    colunas[2] = f.getData_registro();
                    colunas[3] = f.getNome_cliente();
                    colunas[4] = f.getPlaca();                   
                    colunas[5] = f.getValor_parcela();
                    colunas[6] = f.getNum_parcelas();
                    colunas[7] = f.getDia_vencimento();
                    colunas[8] = f.getOberservacao();                
                    tableModel.addRow(colunas);
                }
            }            
        }           
    }//GEN-LAST:event_btnPesquisarFinanciamentoActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnExcluirEntrada;
    private javax.swing.JButton btnImprimirFinanciamento;
    private javax.swing.JButton btnLimparFormularioEntrada;
    private javax.swing.JButton btnPesquisarFinanciamento;
    private javax.swing.JButton btnSalvarFinanciamento;
    private javax.swing.JComboBox<String> cbFiltroFinanciamento;
    private javax.swing.Box.Filler filler1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JToolBar.Separator jSeparator1;
    private javax.swing.JToolBar jToolBar1;
    private javax.swing.JTable tbFinanciamento;
    // End of variables declaration//GEN-END:variables
}
